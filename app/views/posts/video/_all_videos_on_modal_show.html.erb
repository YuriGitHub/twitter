
<% post %>
<% user %>

<% clips = post.attachments.video %>
<% clips.each do |clip| %>
  <div class="row posts-modals-clips-row" id="posts<%=post.id%>-modal-clips<%=clip.id%>-row">

    <div class="col-md-12">
      <%= video_tag clip.file.to_s, :controls => true, class:'posts-modals-clip', id:'posts'+post.id.to_s+'-modal-clip'+clip.id.to_s %>

      <div class="posts-modals-clips-title"><%= clip.file.to_s.split('/').last %></div>
      <% if user == current_user %>
          <%= link_to 'X', user_post_remove_clip_path(user, post, clip_id: clip), method: :delete, remote: true, class:'posts-modal-clips-remove-link', data:{confirm: 'Are you shure?'} %>
      <% end %>


      <% if user != current_user %>

            <% if !current_user.attachments.video.find_by_id(clip.id) %>
              <%= link_to 'add clip_id'+clip.id.to_s, user_post_add_clip_to_my_videos_path(user, post, clip_id: clip.id), remote: true, method: :put %>

            <% end %>


      <% end %>
    </div>

  </div>
<% end %>

<script>
  $('.posts-modal-clips-remove-link').each(function(){
    $(this).mouseover(function(){
      $(this).attr('title', 'remove');
    });
  });

  $('.posts-modals-clip').each(function(){
    $(this).on('play', function(){
      var clip = $(this);
      $('.posts-modals-clip').each(function(){
        if ($(this).attr('id') != $(clip).attr('id')){
          $(this).trigger('pause');
        }
      });
    });
  });
</script>



