<h1><%= @album.name %></h1>

<%= link_to 'All Photo Albums', user_photo_albums_path(@user), class:'btn btn-default' %>

<% if @user.id == current_user.id %>
  <%= link_to 'Edit Album', edit_user_photo_album_path(@user, @album), class:'btn btn-default' %>
  <%= link_to 'Delete Album', user_photo_album_path(@user, @album), method: :delete, data:{confirm: 'Are you  shure?'}, class:'btn btn-default' %>

    <h2>Add Photo To Album</h2>
    <%=form_for([@user, @album.attachments.build], url: user_add_photo_to_album_path(id: @album), html:{:multipart => true, :class => 'dropzone', :id => 'file_upload_form'}) do |f|%>

        <div class="fallback">
          <%=f.file_field :file, accept:'image/*'%>
          <%=f.submit "Upload"%>
        </div>
    <%end%>
    <script type="text/javascript" charset="utf-8">
      Dropzone.autoDiscover = false;
      $("#file_upload_form").dropzone({
        autoProcessQueue :true,
        maxFilesize: 700,
        acceptedFiles: ".jpeg,.jpg,.png,.gif",
        paramName: "attachment[file]",
        addRemoveLinks: true
      });
    </script>

<% end %>
<div id="blueimp-gallery" class="blueimp-gallery">
  <div class="slides"></div>
  <h3 class="title"></h3>
  <a class="prev">‹</a>
  <a class="next">›</a>
  <a class="close">×</a>
  <a class="play-pause"></a>
  <ol class="indicator"></ol>
</div>

<div id="links">

    <% @album.photos.each_slice(3) do |photos| %>
        <div class="row" >
           <% photos.each do |photo| %>
              <div class="col-md-4">
                <a href="<%= photo.file.to_s %>" title="Title" >
                  <%=image_tag photo.file.to_s, class:'gallery-picture'  %>
                </a>
              </div>
           <% end %>
        </div>
    <% end %>



</div>


<script>
  document.getElementById('links').onclick = function (event) {
    event = event || window.event;
    var target = event.target || event.srcElement,
        link = target.src ? target.parentNode : target,
        options = {index: link, event: event},
        links = this.getElementsByTagName('a');
    blueimp.Gallery(links, options);
  };
</script>


</div>